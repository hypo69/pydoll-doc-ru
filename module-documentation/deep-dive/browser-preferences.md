# Глубокое погружение: Пользовательские настройки браузера в Pydoll

## Обзор
Функция `browser_preferences` (PR #204) обеспечивает прямой, детальный контроль над настройками браузера Chromium через API `ChromiumOptions`. Это необходимо для расширенных сценариев автоматизации, тестирования и сбора данных, где требуется настройка поведения браузера по умолчанию.

## Как это работает
- `ChromiumOptions.browser_preferences` — это словарь, который напрямую сопоставляется с внутренней структурой настроек Chromium.
- Настройки объединяются: установка новых ключей обновляет только эти ключи, сохраняя остальные.
- Для общих сценариев предоставляются вспомогательные методы (`set_default_download_directory`, `set_accept_languages` и т. д.).
- Настройки применяются перед запуском браузера, гарантируя, что все настройки вступят в силу с самого начала сеанса.
- Проверка гарантирует, что принимаются только словари; недопустимые структуры вызывают четкие ошибки.

## Пример
```python
options = ChromiumOptions()
options.browser_preferences = {
    'download': {'default_directory': '/tmp', 'prompt_for_download': False},
    'intl': {'accept_languages': 'en-US,en'},
    'profile': {'default_content_setting_values': {'notifications': 2}}
}
```

## Расширенное использование
- **Объединение:** Несколько присваиваний объединяют ключи, поэтому вы можете постепенно создавать свои настройки.
- **Проверка:** Если вы передаете не словарь или используете зарезервированный ключ 'prefs', возникает ошибка.
- **Внутреннее устройство:** Настройки устанавливаются с помощью рекурсивного сеттера, который при необходимости создает вложенные словари.
- **Интеграция:** Используется менеджером процессов браузера для инициализации каталога пользовательских данных с вашими пользовательскими настройками.

## Рекомендации
- Используйте вспомогательные методы для общих шаблонов; устанавливайте `browser_preferences` напрямую для расширенных нужд.
- Проверьте документацию Chromium на наличие доступных настроек: https://chromium.googlesource.com/chromium/src/+/4aaa9f29d8fe5eac55b8632fa8fcb05a68d9005b/chrome/common/pref_names.cc
- Избегайте установки экспериментальных или недокументированных настроек, если вы не знаете их последствий.

## Ссылки
- Подробности реализации см. в `pydoll/browser/options.py`.
- Примеры использования см. в тестах в `tests/test_browser/test_browser_chrome.py`.